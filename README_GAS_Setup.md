# Instructions for Google Apps Script w/ Clasp and TypeScript

[![License](https://img.shields.io/badge/License-ISC-darkblue)](https://opensource.org/licenses/ISC)
![Version](https://img.shields.io/badge/Version-1.0.0-purple.svg)


[![Typescript](https://img.shields.io/badge/</>-typescript-4285f4)](https://www.typescriptlang.org/)
[![Clasp](https://img.shields.io/badge/built%20with-clasp-4285f4.svg)](https://github.com/google/clasp)
[![Code Style: Google](https://img.shields.io/badge/code%20style-google-blueviolet.svg)](https://github.com/google/gts)


These instructions are meant to help you orient to the development environment.
They are not exhaustive and can be used as guidelines to create common ground.
Please include them in any CCI GAS repository and keep them up-to-date.

### Version History
- Version 1 Author(s): Jack Olsen

#
## Setup

### Initial Global Installs (if not met already)
```sh
# Install typescript globally
npm install -g typescript

# Install clasp globally and login
npm install -g @google/clasp
```
<br>

clasp### [Clasp](https://github.com/google/clasp) Details
```sh
# Login with google credentials
clasp login
xsz
# Logout at end of session
clasp logout
```

Update `scriptId` in Project Settings File (`.clasp.json`) to match target GAS

> Find Script ID in URL of the GAS editor:  
> <div>https://script.google.com/home/projects/[ scriptId ]/edit</div>
<br>

Note that `rootDir` in Project Settings File is set to `./GAS/`

<br>

### Local Installs
As detailed by `package.json` (or `package-lock.json`) file
```sh
# Install dependencies locally
npm install
```
<br>



## Linting via [gts](https://github.com/google/gts)
```sh
# Scripts (autogenerated by gts):
npm run lint
npm run clean
npm run compile
npm run fix
npm run prepare
npm run pretest
npm run posttest
```
Performs linting following Google's TypeScript style guide (using [ESLint](https://eslint.org/) and [Prettier](https://prettier.io/)).  
<br>

## Essential [Clasp](https://github.com/google/clasp) Commands
```sh
# Pull files from the linked GAS project
clasp pull

# Push files to the linked GAS project
clasp push [--watch] [--force]
```

# 
## Update All Templates
```cmd
@rem Windows
updateTemplates.bat
```
```bash
# Linux/Mac
bash updateTemplates.sh
```
Update `ScriptIDList.txt` with all of the destination scripts.
This file is `:` separated as  
```Template Name:ScriptID:``` (Note the trailing `:`)

Run the script to use the push command on all destination scripts.
